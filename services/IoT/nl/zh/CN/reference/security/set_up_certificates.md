---

copyright:
  years: 2015,2016

---

{:new_window: target="\_blank"}
{:shortdesc: .shortdesc}
{:screen:.screen}
{:codeblock:.codeblock}
{:pre: .pre}

# 设置证书
{: #set_up_certificates.md}
上次更新时间：2016 年 11 月 15 日
{: .last-updated}

通过使用风险和安全管理附加组件，证书可用于设备认证，或者替换 MQTT 消息传递的缺省 IBM Watson IoT Platform 服务器证书。没有有效签名证书的任何设备将被拒绝访问，无法与服务器通信。

要为设备配置证书和服务器访问权限，系统操作员应将关联的认证中心 (CA) 证书注册到 Watson IoT Platform，还可以选择将消息服务器证书注册到 Watson IoT Platform。

## 证书要求

您注册的证书必须将设备标识输入为证书中的 Common Name (CN) 或 SubjectAltName。对于 *CN* 字段，格式为 CN=d:devtype:devid。对于 SubjectAltName 字段，格式为：SubjectAltName=d:devtype:devid，其中 devtype 是设备的设备类型，devid 是设备的客户机标识。 

在 Beta 发行版中不支持使用证书撤销列表 (CRL)，该列表指示不再允许连接哪些设备。

如果您添加 CA 证书或者替换消息传递服务器证书，那么必须使用支持服务器名称指示 (SNI) 的 MQTT 客户机连接所有设备。在多租户体系结构中，SNI 告知 MQTT 服务器每个组织/租户连接应使用哪个证书。

##注册认证中心 (CA) 证书进行设备认证 

1. 登录 Watson IoT Platform，并导航到**常规设置**。
2. 在**风险管理**部分的 **CA 证书**下，单击**添加证书**。
3. 浏览以选择要上传的证书文件，或者将文件拖放到**添加证书**窗口中。该文件中只能有一个证书，并且证书日期必须有效。可接受扩展名为 .pem、.cer、.cert 或 .crt 的文件。您可以预览所选文件中的证书信息。
4. 输入证书文件的描述。
5. 确认已选择正确的文件，然后单击**保存**。所选证书会在表中列出，缺省情况下，该证书处于活动状态。

## 注册消息传递服务器证书

平台提供了缺省的服务器证书。您可以使用其中一个缺省证书或者从组织上传一个证书。如果您尚没有要使用的证书，您可以创建新证书请求。接收到新证书之后，必须进行签名，然后上传回平台。

要使用某个缺省证书或者是已经上传的其他证书，请从**消息传递服务器证书**下表格中的**缺省消息传递服务器证书**下拉列表中选择要使用的证书。

### <a name="upload"> </a>从组织上传证书

1. 在**常规设置**的**风险管理**部分中，**消息传递服务器证书**下，单击**添加证书**。
2. 浏览以选择要上传的证书文件，或者将文件拖放到**添加证书**窗口中。
3. 浏览以选择要上传的专用密钥文件，或者将文件拖放到**添加证书**窗口中。  
4. 如果专用密钥已使用口令进行加密，请输入专用密钥口令。
5. 确认已选择正确的文件，然后单击**保存**。
6. 从**缺省消息传递服务器证书**下拉列表中选择新上传的证书。所选证书将作为活动证书显示在表中。


### 请求新证书

 如果想要使用新的消息传递服务器证书，可以生成证书签名请求 (CSR) 来请求新证书。

 1. 在**常规设置**的**风险管理**部分中，**消息传递服务器证书**下，单击**生成 CSR**。
 2. 输入详细信息，以为服务器请求证书签名请求 (CSR)，然后单击**生成**。CSR 将显示在表中。
 3. 下载请求，并将其提交到认证中心以进行签名。
 4. 获取证书之后，您可以按照从组织上传证书的步骤上传证书。证书上传后，表中的 CSR 将替换为已上传的证书。
