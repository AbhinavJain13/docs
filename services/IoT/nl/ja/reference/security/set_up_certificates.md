---

copyright:
  years: 2015,2016

---

{:new_window: target="\_blank"}
{:shortdesc: .shortdesc}
{:screen:.screen}
{:codeblock:.codeblock}
{:pre: .pre}

# 証明書のセットアップ
{: #set_up_certificates.md}
最終更新日: 2016 年 11 月 15 日
{: .last-updated}

リスク管理とセキュリティー管理のアドオンでは、デバイス認証のために証明書を使用したり、IBM Watson IoT Platform の MQTT メッセージング用のデフォルトのサーバー証明書を置き換えたりします。署名付きの有効な証明書のないデバイスは、アクセスを拒否され、サーバーと通信できません。

デバイスの証明書やサーバーへのアクセスを構成するには、システム・オペレーターが、関連する認証局 (CA) 証明書を Watson IoT Platform に登録します。オプションでメッセージ・サーバーの証明書も登録できます。

## 証明書の要件

登録する証明書には、デバイス ID が共通名 (CN) または SubjectAltName として入力されている必要があります。*CN* フィールドの形式は CN=d:devtype:devid です。SubjectAltName フィールドの形式は SubjectAltName=d:devtype:devid です。devtype はデバイスのデバイス・タイプであり、devid はデバイスのクライアント ID です。

ベータ版では、接続を許可されなくなったデバイスを示すリスト、つまり、証明書失効リスト (CRL) の使用はサポートされていません。

CA 証明書を追加したり、メッセージング・サーバー証明書を置き換えたりする場合は、すべてのデバイスが、Server Name Indication (SNI) をサポートする MQTT クライアントを使用して接続している必要があります。マルチテナンシー・アーキテクチャーでは、SNI によって、MQTT サーバーは組織/テナントの接続ごとに使用する証明書を判別できます。

##デバイス認証のための認証局 (CA) 証明書の登録

1. Watson IoT Platform にログインして、**「一般設定」**に移動します。
2. **「リスク管理」**セクションの**「CA 証明書」**で**「証明書の追加」**をクリックします。
3. 「参照」をクリックして、アップロードする証明書ファイルを選択するか、**「証明書の追加」**ウィンドウにファイルをドラッグ・アンド・ドロップします。そのファイルは、証明書が 1 つだけ入っているファイルでなければならず、証明書の日付が有効でなければなりません。.pem、.cer、.cert、.crt のいずれかの拡張子が付いているファイルを使用できます。選択したファイルに入っている証明書の情報をプレビューすることもできます。
4. 証明書ファイルの説明を入力します。
5. 正しいファイルを選択したことを確認して、**「保存」**をクリックします。選択した証明書がテーブルのリストに表示され、デフォルトでアクティブになります。

## メッセージ・サーバー証明書の登録

プラットフォームには、デフォルトのサーバー証明書が複数用意されています。デフォルトの証明書のいずれかを使用することも、組織の証明書をアップロードすることもできます。使用する証明書がない場合は、新しい証明書の要求を作成できます。新しい証明書を受け取ったら、署名を付けてからプラットフォームにアップロードしなければなりません。

デフォルトの証明書またはアップロードした別の証明書を使用するには、**「メッセージング・サーバー証明書」**の下にある表の**「デフォルトのメッセージング・サーバー証明書」**ドロップダウン・リストから、使用する証明書を選択します。

### <a name="upload"> </a> 組織の証明書のアップロード

1. **「一般設定」**の**「リスク管理」**セクションにある**「メッセージング・サーバー証明書」**で**「証明書の追加」**をクリックします。
2. 「参照」をクリックして、アップロードする証明書ファイルを選択するか、**「証明書の追加」**ウィンドウにファイルをドラッグ・アンド・ドロップします。
3. 「参照」をクリックして、アップロードする秘密鍵ファイルを選択するか、**「証明書の追加」**ウィンドウにファイルをドラッグ・アンド・ドロップします。  
4. 秘密鍵がパスフレーズで暗号化されている場合は、そのパスフレーズを入力します。
5. 正しいファイルを選択したことを確認して、**「保存」**をクリックします。
6. **「デフォルトのメッセージング・サーバー証明書」**ドロップダウン・リストから、アップロードした新しい証明書を選択します。選択した証明書がテーブルのリストにアクティブな証明書として表示されます。


### 新しい証明書の要求

 新しいメッセージング・サーバー証明書を使用する場合は、証明書署名要求 (CSR) を生成して新しい証明書を要求できます。

 1. **「一般設定」**の**「リスク管理」**セクションにある**「メッセージング・サーバー証明書」**で**「CSR の生成」**をクリックします。
 2. サーバーの証明書署名要求 (CSR) を要求するための詳細情報を入力して、**「生成」**をクリックします。CSR がテーブルに表示されます。
 3. 要求をダウンロードして、署名を得るために認証局に送信します。
 4. 証明書を取得したら、「組織の証明書のアップロード」の手順でアップロードできます。証明書をアップロードすると、テーブル内の CSR が、アップロードした証明書に置き換わります。
