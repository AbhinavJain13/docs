---

タイトル: ユーザー・ベースのプッシュ通知の使用可能化

キーワード: ユーザー・ベースのプッシュ通知、userId
copyright:
 years: 2015, 2016

---

# ユーザー・ベースの通知の使用可能化
{: #user_based_notifications}
最終更新日: 2016 年 8 月 16 日
{: .last-updated}

ユーザー ID ベースの{{site.data.keyword.mobilepushshort}}は、カスタマイズしたメッセージを使用し、モバイル・アプリ・ユーザーをターゲットとします。ユーザー・ベースの通知を利用して、特定の個人が自分の個人用設定や選択を活用できるようにすることができます。  

## ユーザー ID を使用したデバイスの登録
ユーザー ID によってターゲット指定されるプッシュ通知を有効にするには、必ず、デバイスをユーザー ID に登録し、{{site.data.keyword.mobilepushshort}}サービスのプロビジョン時に割り振られる「clientSecret」も渡してください。有効な「clientSecret」がないと、デバイス登録は失敗します。  

ユーザー ID には、アプリケーションがデバイス登録 API に提供する任意のストリングが可能です。通常、モバイル・アプリケーションはまず、[{{site.data.keyword.amafull}}](https://console.ng.bluemix.net/docs/services/mobileaccess/index.html) などの認証サービスに対してモバイル・アプリ・ユーザーを認証する認証サイクルを実行します。認証に成功すると、認証ユーザー ID が「clientSecret」とともにプッシュ・デバイス登録 API に渡されます。「clientSecret」の存在により、ユーザー ID とモバイル・デバイス登録の許可された関連付けのみが実行されます。


「clientSecret」は機密とし、モバイル・アプリへのハードコーディングは絶対に行わないでください。アプリケーションの実行時に「clientSecret」を動的にプルするために使用できる、さまざまなアプリケーション初期化パターンがあります。以下のシーケンス図に、このパターンの概要を示します。

![通知の使用可能化](images/init_client_secret.jpg) 

また、「匿名」ユーザーに関連付けるデバイスも登録できます。これには、ユーザー ID と「clientSecret」の引数を要求しない、デバイス登録 API のバリアントを使用する必要があります。   

## ユーザーのログイン/ログアウトの同期化とプッシュ通知の使用可能化 

ユーザーがログインしている場合にのみ通知を送信するようにすることができます。 

例えば、デバイスを家族や職場のチームで共有していて、家族またはチーム内の特定ユーザーに対処する必要がある場合があります。そうしたユース・ケースでは、アプリケーションを保護してアプリケーションの現在のユーザーの ID を追跡する、ユーザーのログインとログアウトのシーケンスがあります。特定ユーザーをターゲットとした通知を常にそのユーザーだけが受信するようにするには、正常にログインした後に、 ログイン・ユーザーのユーザー ID を受け渡すデバイス登録 API を呼び出します。ログアウトの前にも同様に、デバイス登録抹消 API を呼び出します。これらのプッシュ API をログインとログアウトでシーケンスにすることで、特定のユーザー向けに意図したプッシュ通知がそのユーザーだけに送信されるようになります。
